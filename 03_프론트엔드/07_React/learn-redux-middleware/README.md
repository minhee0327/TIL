# 리덕스 미들웨어 학습

- 미들웨어 만들어보기
  - (middlewares/myLogger.js)
- redux-logger 사용 및 redux Devtool 사용 (index.js)
- redux-thunk (비동기 다루기, 라우터 연동하기)
  - react-router 적용해서 특정 포스트 읽기 구현
  - API는 임의로 posts객체 구현하여 실습함.
  - API 재로딩문제 해결하기
    - 포스트 목록 재로딩 문제 해결
      - 방법1 데이터가 이미 존재한다면 요청하지 않도록하기 (containers/PostListContainer.js)
      - 방법2 로딩을 새로하긴 하는데, '로딩중...'을 띄우지 않기 (lib/asyncUtils.js - handleAsyncActions)
        - 장점: 사용자에게 좋은 경험 제공가능
        - 뒤로가기를 통해 다시 포스트 목록 조회시 최신 데이터 보여줄 수 있음
    - 포스트 조회시 재로딩 문제 해결
      - 어떤 파라미터가 주어졌느냐에 따라 다른 결과물이 있기 때문에 위와 같이 수정 불가.
      - 방법1: 컴포넌트가 언마운트 될 때 포스트 내용 비우기
        - posts 리덕스모듈에 액션 추가(CREAR_POST) + PostContainer에서 언마운트 시점에 clearPost함수 호출
          - 이미 읽었던 포스트를 불러올 경우에도 새로 요청을 하기 때문에 posts 모듈에서 관리하는 상태구조를 바꿔야함
      - 데이터를 제대로 캐싱하고 싶을때는 요청을 하지 않는 방식
      - 포스트 정보가 바뀔 가능성이 있는 경우 새로불러오되, 로딩중은 표시하지 않는 형태로 구현하기
      - 현재 프로젝트는 아예 요청을 하지 않는 방식으로 마무리함.
  - thunk에서 라우터 연동하기
    - 예: 로그인 요청 성공시 / 경로로 이동, 실패시 경로 유지형태
      - 방법1: 컨테이너 컴포넌트 내에 단순히 withRouter를 사용해서, props로 history를 가져와서 사용
      - 방법2: thunk에서 처리 (코드 깔끔)
- json-server
  - 가짜 API 서버를 만들건데 (test용 서버) 이때 사용하는 도구 (json-server)
  - json server 띄운채로 실습할것(client측에서 요청했을때 서버가 내려져있으면 해당 정보를 보내줄 수 없음)
- CORS 규칙
  - 다른 도메인에서 API를 요청해서 사용할 수 있게 해주려면 설정해야함.
  - json-server로 만든 서버의 경우엔, 모든 도메인을 허용하는 CORS 규칙이 적용되어 있음.
  - Open API를 만드는게 아닐때는 모든 도메인을 허용해서는 안됨.
  - 따라서 특정 도메인으로 접근하고 싶을때에는 백엔드 개발자분께 해당 도메인을 허용해달라고 요청을 할 수도 있겠지만,
  - 웹팩 개발서버에서 제공되는 Proxy기능을 사용해서 해결할 수 있음.
  - 원래 웹팩 배발 서버의 proxy설정은 웹팩 설정을 통해 적용해야하지만, CRA를 통해 만든 프로젝트에는 package.json에 "proxy"값을 설정하여 적용할 수 있음!
  - 또한, 배포시, 만든서비스랑 API가 다른 도메인을 사용한다면, baseURL을 설정해서 해결가능
